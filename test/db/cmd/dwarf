NAME="pdf dwarf invalid main for analysis not found (aa)"
FILE=bins/src/dwarftest
CMDS=<<EOF
e asm.dwarf=true
e anal.nopskip=true # if set to true it fucks the test
aa
pd 1 @main
EOF
EXPECT=<<EOF
            ; DATA XREF from entry0 @ 0x40045d
/ 44: int main (int argc, char **argv, char **envp);
|           ; var int64_t var_4h @ rbp-0x4
|           0x0040052d      55             push rbp                    ; dwarftest.c:4
EOF
RUN

NAME="Mach-O dSYM lines (armv7)"
FILE=bins/mach0/TestRTTI-armv7-dSYM
CMDS=<<EOF
CL 0x0000a24e
EOF
EXPECT=<<EOF
file: /Users/ftamagni/src/TestRTTI/TestRTTI//TestRTTI.cpp
line: 18
EOF
RUN

NAME="variable info integration"
FILE=bins/elf/dwarf3_many_comp_units.elf 
CMDS=<<EOF
e asm.dwarf=false
aaa
pd 13 @ main
EOF
EXPECT=<<EOF
            ; DATA XREF from entry0 @ 0x10c1
            ;-- main:
/ 139: int dbg.main (int argc, char **argv, char **envp);
|           ; var int output @ rbp-0x24
|           ; var Bird *b @ rbp-0x20
|           ; var Mammal *m @ rbp-0x18
|           0x0000123b      f30f1efa       endbr64
|           0x0000123f      55             push rbp
|           0x00001240      4889e5         mov rbp, rsp
|           0x00001243      53             push rbx
|           0x00001244      4883ec28       sub rsp, 0x28
|           0x00001248      bf08000000     mov edi, 8
|           0x0000124d      e81efeffff     call sym.imp.operator_new_unsigned_long
|           0x00001252      4889c3         mov rbx, rax
|           0x00001255      4889df         mov rdi, rbx
|           0x00001258      e827010000     call method Bird::Bird()    ; dbg.Bird::Bird()
|           0x0000125d      48895de0       mov qword [b], rbx
|           0x00001261      bf08000000     mov edi, 8
|           0x00001266      e805feffff     call sym.imp.operator_new_unsigned_long
EOF
RUN